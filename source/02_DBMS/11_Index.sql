-- [XI] 인덱스: 조회를 빠르게 하는 인덱스
DROP TABLE EMP01;
CREATE TABLE EMP01 -- EMP테이블과 내용이 같은 EMP01 생성
    AS SELECT * FROM EMP;
SELECT * FROM EMP01; -- 14행
INSERT INTO EMP01 SELECT * FROM EMP01; -- 데이터 뻥튀기 1번(28행), 2번(56행)
SELECT TO_CHAR(COUNT(*), '9,999,999') COUNT FROM EMP01;
INSERT INTO EMP01 SELECT * FROM EMP01; -- 11번 실행
SELECT TO_CHAR(COUNT(*), '9,999,999') COUNT FROM EMP01; -- 약 11만행
-- 홍길동 데이터 하나 삽입
INSERT INTO EMP01 (EMPNO, ENAME, DEPTNO) VALUES (1111, '홍길동', 40);
INSERT INTO EMP01 SELECT * FROM EMP01; -- 1번(22만), 2번(44만), 3번(90만)
SELECT TO_CHAR(COUNT(*), '9,999,999') COUNT FROM EMP01;

-- INDEX 없이 조회할 경우
SELECT * FROM EMP01 WHERE ENAME = '홍길동'; -- 0.016초
-- INDEX 생성
CREATE INDEX IDX_EMP01_ENAME ON EMP01(ENAME); --0.654초

SELECT * FROM EMP01 WHERE ENAME = '홍길동'; -- INDEX 생성 후 조회할 경우(0.001초)
COMMIT;
INSERT INTO EMP01 SELECT * FROM EMP01; -- INDEX 생성 후 INSERT(91만 -> 183만) (37.821초) B*TREE 조정 시간 오래걸려
ROLLBACK; -- 183만 -> 91만 (10.077초)

-- INDEX 삭제 후 다시 INSERT 하면?
DROP INDEX IDX_EMP01_ENAME;
SELECT TO_CHAR(COUNT(*), '9,999,999') COUNT FROM EMP01; -- 현재 91만행
INSERT INTO EMP01 SELECT * FROM EMP01; -- 91만 -> 183만(2.857초)
DROP TABLE EMP01; -- 테이블 삭제하면 해당 테이블의 INDEX도 자동 삭제
